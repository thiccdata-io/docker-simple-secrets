<div class="secret-edit">
  <form
    class="secret-edit-form"
    hx-put="/services/<%= serviceName %>/secrets/<%= secretName %>"
    hx-target="#secret-value-<%= serviceName %>-<%= secretName %>"
    hx-swap="innerHTML"
  >
    <div class="secret-actions">
      <button type="submit" class="btn btn-small btn-primary">ðŸ’¾ Save</button>
      <button
        type="button"
        class="btn btn-small btn-secondary"
        hx-get="/services/<%= serviceName %>/secrets/<%= secretName %>"
        hx-target="#secret-value-<%= serviceName %>-<%= secretName %>"
        hx-swap="innerHTML"
      >
        Cancel
      </button>
    </div>
    <textarea 
      name="secretValue" 
      class="secret-edit-input" 
      rows="20" 
      required
      spellcheck="false"
      data-enable-tab-indent
    ><%= secretValue %></textarea>
  </form>
</div>

<script>
(function() {
  // Enable tab indentation for textareas with data-enable-tab-indent attribute
  document.querySelectorAll('textarea[data-enable-tab-indent]').forEach(function(textarea) {
    textarea.addEventListener('keydown', function(e) {
      if (e.key === 'Tab') {
        e.preventDefault();
        
        const start = this.selectionStart;
        const end = this.selectionEnd;
        const value = this.value;
        
        // Insert 2 spaces at cursor position
        this.value = value.substring(0, start) + '  ' + value.substring(end);
        
        // Move cursor after the inserted spaces
        this.selectionStart = this.selectionEnd = start + 2;
      }
    });
  });
})();
</script>
